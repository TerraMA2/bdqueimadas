<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
<!-- jQuery 2.1.4 -->
<script src="/externals/jQuery/jQuery-2.1.4.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
  $.widget.bridge('uibutton', $.ui.button);
</script>
<!-- Bootstrap 3.3.5 -->
<script src="/externals/bootstrap/js/bootstrap.min.js"></script>
<!-- Sparkline -->
<script src="/externals/sparkline/jquery.sparkline.min.js"></script>
<!-- jvectormap -->
<script src="/externals/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
<script src="/externals/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
<!-- jQuery Knob Chart -->
<script src="/externals/knob/jquery.knob.js"></script>
<!-- daterangepicker -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.2/moment.min.js"></script>
<script src="/externals/daterangepicker/daterangepicker.js"></script>
<!-- datepicker -->
<script src="/externals/datepicker/bootstrap-datepicker.js"></script>
<!-- Bootstrap WYSIHTML5 -->
<script src="/externals/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
<!-- Slimscroll -->
<script src="/externals/slimScroll/jquery.slimscroll.min.js"></script>
<!-- FastClick -->
<script src="/externals/fastclick/fastclick.min.js"></script>
<!-- AdminLTE App -->
<script src="/externals/adminlte/js/app.min.js"></script>
<!-- DataTables -->
<script src="/externals/datatables/jquery.dataTables.min.js"></script>
<script src="/externals/datatables/dataTables.bootstrap.min.js"></script>
<!-- ChartJS 1.0.1 -->
<script src="/externals/chartjs/Chart.min.js"></script>
<!-- OpenLayers  -->
<script src="/externals/openlayers/ol.js" type="text/javascript"></script>
<script src="/javascripts/bdqueimadas.js" type="text/javascript"></script>
<script type="text/javascript">
  var terrama2 = new TerraMA2(
    "<%= terrama2Path %>",
    [
      "MapDisplay",
      "LayerExplorer"
    ]
  );

  var bdqueimadas = new BDQueimadas(terrama2);

  $(".sidebar-menu > li").on('click', function(event) {
    event.preventDefault();

    var box = $(this).attr('box');
    var id = $(this).attr('id');

    if(box !== "" && box !== undefined) {
      var active = $("#" + box).hasClass('active');

      closeAllContentBoxes();
      closeBg();

      if(!active) {
        openBg(id, box);
        openContentBox(box);
      }
    } else {
      var active = $("#left-content-box-background").hasClass('active');
      var boxActive = $("#left-content-box-background").attr('box');

      closeAllContentBoxes();
      closeBg();

      if(boxActive !== id || !active) {
        openBg(id, '');
      }
    }
  });

  $('.sidebar-toggle').on('click', function() {
    if($(".left-content-box").hasClass('active')) {
      var currentBox = $("#" + $("#left-content-box-background").attr('box')).attr('box');
      ajustBoxesSize(currentBox);
    }

    if($("#left-content-box-background").hasClass('active')) {
      ajustBoxesSize("left-content-box-background");
    }

    if($("body").hasClass('sidebar-collapse')) {
      $("#terrama2-map").addClass('fullmenu');
    } else {
      $("#terrama2-map").removeClass('fullmenu');
    }

    terrama2.getMapDisplay().updateMapSize();
  });

  var closeBg = function() {
    $("#left-content-box-background").removeClass('active');
    $("#left-content-box-background").animate({ width: '350px', left: '-350px' }, { duration: 300, queue: false });
    $("#left-content-box-background").attr('box', '');
  }

  var closeAllContentBoxes = function() {
    $(".left-content-box").removeClass('active');
    $(".left-content-box").removeClass('fullmenu');
    $(".left-content-box").animate({ left: '-100%' }, { duration: 300, queue: false });
  }

  var ajustBoxesSize = function(id) {
    if($("#" + id).css('left') === '230px') {
      $("#" + id).animate({ left: '50px' }, { duration: 250, queue: false });
      if($("#" + id).hasClass('fullscreen')) $("#" + id).removeClass('fullmenu');
    } else {
      $("#" + id).animate({ left: '230px' }, { duration: 400, queue: false });
      if($("#" + id).hasClass('fullscreen')) $("#" + id).addClass('fullmenu');
    }
  }

  var openBg = function(box, contentBox) {
    var width = '';
    var left = '';

    if(contentBox !== '' && $("#" + contentBox).hasClass('fullscreen')) {
      width = '100%';
    } else {
      width = '350px';
    }

    if($("body").hasClass('sidebar-collapse')) {
      left = '50px';
    } else {
      left = '230px';
    }

    $("#left-content-box-background").addClass('active');
    $("#left-content-box-background").attr('box', box);
    $("#left-content-box-background").animate({ width: width, left: left }, { duration: 300, queue: false });
  }

  var openContentBox = function(box) {
    $("#" + box).addClass('active');

    if($("body").hasClass('sidebar-collapse')) {
      $("#" + box).animate({ left: '50px' }, { duration: 300, queue: false });
    } else {
      if($("#" + box).hasClass('fullscreen')) $("#" + box).addClass('fullmenu');
      $("#" + box).animate({ left: '230px' }, { duration: 300, queue: false });
    }
  }
</script>
